<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Snake Monxia</title>
  <!-- Farcaster Frame -->
  <meta property="fc:frame" content="vNext">
  <meta property="fc:frame:image" content="https://snake-monxia.vercel.app/og.png">
  <meta property="fc:frame:button:1" content="Play Snake">
  <meta property="fc:frame:button:1:action" content="link">
  <meta property="fc:frame:button:1:target" content="https://snake-monxia.vercel.app">
  
  <style>
    :root {
      --bg: #0b0211;
      --card: #12051a;
      --accent: #9b59ff;
      --muted: #9e88b8;
      --glass: rgba(255, 255, 255, 0.03);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; font-family: system-ui, sans-serif; background: var(--bg); color: #eee; overflow: hidden; }
    body { display: flex; flex-direction: column; padding: 12px; gap: 12px; }
    @media (min-width: 768px) { body { padding: 28px; } }
    .wrap { display: flex; flex-direction: column; height: 100%; gap: 12px; }
    @media (min-width: 768px) { .wrap { flex-direction: row; } }
    .card { background: var(--card); border-radius: 14px; padding: 16px; border: 1px solid rgba(155,89,255,0.1); }
    .left { flex: 1; display: flex; flex-direction: column; gap: 12px; }
    @media (min-width: 768px) { .left { flex: 0 0 480px; } }
    .right { display: none; }
    @media (min-width: 768px) { .right { display: block; flex: 1; } }
    header h1 { margin: 0; font-size: 18px; color: var(--accent); }
    .small { font-size: 11px; color: var(--muted); }
    .top-row { display: flex; justify-content: space-between; align-items: center; gap: 8px; flex-wrap: wrap; }
    .btn { background: linear-gradient(90deg, var(--accent), #6f4bff); border: none; color: #fff; padding: 10px 14px; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 14px; transition: opacity 0.2s; }
    .btn:hover { opacity: 0.9; }
    .btn.ghost { background: transparent; border: 1px solid rgba(255,255,255,0.1); color: var(--muted); }
    .menu { display: flex; flex-direction: column; gap: 8px; }
    #gameHolder { position: relative; flex: 1; }
    canvas { width: 100%; height: 100%; image-rendering: pixelated; border-radius: 10px; background: #05020b; border: 1px solid rgba(255,255,255,0.05); }
    #wallet-section { display: flex; gap: 6px; align-items: center; margin-top: 4px; flex-wrap: wrap; }
    #addr { font-weight: bold; }
    #network { font-size: 12px; color: var(--muted); }
    #connectBtn { display: inline-block; }
    #disconnectBtn { display: none; }
    .screen { display: none; }
    .screen.active { display: block; }
    .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 999; backdrop-filter: blur(8px); }
    .modal { background: var(--card); padding: 20px; border-radius: 14px; width: 90%; max-width: 400px; border: 1px solid rgba(155,89,255,0.1); }
    .processing { position: fixed; top: 0; left: 0; right: 0; height: 4px; display: none; z-index: 1000; }
    .processing .bar { height: 100%; background: linear-gradient(90deg, #2b0a3f, var(--accent), #4b2bff); animation: shimmer 1.2s infinite; }
    @keyframes shimmer { from { background-position: 0 0; } to { background-position: 200% 0; } }
  </style>
</head>
<body>
  <div class="processing" id="processing"><div class="bar"></div></div>
  
  <div class="wrap">
    <div class="card left">
      <header>
        <h1>Snake Monxia</h1>
        <div class="small">Retro web3 â€¢ Play, mint snakes, pay-per-food or prepay</div>
      </header>
      
      <div class="top-row">
        <div>
          <div class="small">Wallet</div>
          <div id="wallet-section">
            <button id="connectBtn" class="btn">Connect</button>
            <button id="disconnectBtn" class="btn ghost">Disconnect</button>
            <div id="addr" class="small">Not connected</div>
            <div id="network" class="small"></div>
          </div>
        </div>
      </div>
      
      <div id="menu" class="menu">
        <button id="newGame" class="btn">New Game</button>
        <button id="buy" class="btn ghost">Buy Snakes</button>
        <button id="deposit" class="btn ghost">Deposit</button>
        <button id="leaderboardBtn" class="btn ghost">Leaderboard</button>
        <button id="help" class="btn ghost">Help</button>
      </div>
      
      <div id="gameHolder" style="display: none;">
        <canvas id="canvas" width="420" height="420"></canvas>
      </div>
    </div>
    
    <div class="card right" id="screens">
      <div id="screenMenu" class="screen active">
        <h3>Main Menu</h3>
        <div class="small">Choose an action to continue.</div>
      </div>
      
      <div id="screenBuy" class="screen">
        <h3>Buy Snakes</h3>
        <div style="display: flex; gap: 8px; margin-top: 10px; flex-wrap: wrap;">
          <button id="mintClassicBtn" class="btn">Mint Classic (0.01 MON)</button>
          <button id="mintFastBtn" class="btn">Mint Fast (1 MON)</button>
          <button id="mintHeartyBtn" class="btn">Mint Hearty (1 MON)</button>
          <button id="mintLongBtn" class="btn">Mint Long (1 MON)</button>
        </div>
        <div style="margin-top: 12px;">
          <button id="buyBack" class="btn ghost">Back</button>
        </div>
      </div>
    </div>
  </div>
  
  <div class="modal-backdrop" id="modal">
    <div class="modal">
      <h3 id="modalTitle">Game Over</h3>
      <div id="modalBody" class="small">Score: <strong id="finalScore">0</strong></div>
      <div style="margin-top: 16px; display: flex; gap: 8px; justify-content: flex-end;">
        <button id="action1" class="btn">New Game</button>
        <button id="action2" class="btn ghost">Back to Menu</button>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/supabase@2.45.4/dist/umd/supabase.js"></script>
  <script type="module">
    // FIXED WALLET CONNECT - Working version
    import { createWeb3Modal, defaultWagmiConfig } from 'https://esm.sh/web3modal@2.4.0?bundle';
    import { WalletConnectConnector } from 'https://esm.sh/@web3modal/ethereum@2.2.0?bundle';
    import { createConfig, http } from 'https://esm.sh/wagmi@2.12.16?bundle';
    import { createPublicClient, createWalletClient, custom, getContract, parseEther } from 'https://esm.sh/viem@2.21.1?bundle';

    const monadTestnet = {
      id: 10143,
      name: 'Monad Testnet',
      nativeCurrency: { name: 'MON', symbol: 'MON', decimals: 18 },
      rpcUrls: { default: { http: ['https://testnet-rpc.monad.xyz'] } },
      blockExplorers: { default: { url: 'https://testnet.monadexplorer.com' } },
      testnet: true
    };

    const projectId = 'd0a0230a461b71859ecd0ffe6433a89d';
    
    const config = createConfig({
      chains: [monadTestnet],
      transports: { [monadTestnet.id]: http() },
      connectors: [
        new WalletConnectConnector({ projectId, showQrModal: true })
      ]
    });

    const modal = createWeb3Modal({ wagmiConfig: config, projectId, themeMode: 'dark' });

    let publicClient, walletClient, contract, userAddress = null;
    const CONTRACT_ADDRESS = '0x238efb5E1DB138E92ae39aAE9f9B6FdcfFd76437';
    // Add your CONTRACT_ABI here from original file
    const FOOD_FEE = 0.004;
    const CONTRACT_ABI = [
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "coinAddress",
                        "type": "address"
                    }
                ],
                "stateMutability": "nonpayable",
                "type": "constructor"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "sender",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    },
                    {
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    }
                ],
                "name": "ERC721IncorrectOwner",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "operator",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "ERC721InsufficientApproval",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "approver",
                        "type": "address"
                    }
                ],
                "name": "ERC721InvalidApprover",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "operator",
                        "type": "address"
                    }
                ],
                "name": "ERC721InvalidOperator",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    }
                ],
                "name": "ERC721InvalidOwner",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "receiver",
                        "type": "address"
                    }
                ],
                "name": "ERC721InvalidReceiver",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "sender",
                        "type": "address"
                    }
                ],
                "name": "ERC721InvalidSender",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "ERC721NonexistentToken",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    }
                ],
                "name": "OwnableInvalidOwner",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "OwnableUnauthorizedAccount",
                "type": "error"
            },
            {
                "inputs": [],
                "name": "ReentrancyGuardReentrantCall",
                "type": "error"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "approved",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "Approval",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "operator",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "approved",
                        "type": "bool"
                    }
                ],
                "name": "ApprovalForAll",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "player",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "count",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "totalPaid",
                        "type": "uint256"
                    }
                ],
                "name": "BatchConsumed",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "_fromTokenId",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "_toTokenId",
                        "type": "uint256"
                    }
                ],
                "name": "BatchMetadataUpdate",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "player",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "DepositToGame",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "player",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "FoodPaid",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "_tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "MetadataUpdate",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "previousOwner",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "newOwner",
                        "type": "address"
                    }
                ],
                "name": "OwnershipTransferred",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "address",
                        "name": "player",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint8",
                        "name": "mode",
                        "type": "uint8"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "score",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "coinsEarned",
                        "type": "uint256"
                    }
                ],
                "name": "ScoreSubmitted",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint8",
                        "name": "skin",
                        "type": "uint8"
                    }
                ],
                "name": "SkinApplied",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    },
                    {
                        "components": [
                            {
                                "internalType": "uint8",
                                "name": "speed",
                                "type": "uint8"
                            },
                            {
                                "internalType": "uint8",
                                "name": "hearts",
                                "type": "uint8"
                            },
                            {
                                "internalType": "uint8",
                                "name": "length",
                                "type": "uint8"
                            },
                            {
                                "internalType": "uint8",
                                "name": "skin",
                                "type": "uint8"
                            },
                            {
                                "internalType": "bool",
                                "name": "isClassic",
                                "type": "bool"
                            }
                        ],
                        "indexed": false,
                        "internalType": "struct SnakeMonxiaGame.SnakeAttributes",
                        "name": "attrs",
                        "type": "tuple"
                    }
                ],
                "name": "SnakeMinted",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "attr",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint8",
                        "name": "newValue",
                        "type": "uint8"
                    }
                ],
                "name": "SnakeUpgraded",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "from",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "Transfer",
                "type": "event"
            },
            {
                "inputs": [],
                "name": "BASE_UPGRADE_COST",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "CLASSIC_MINT_PRICE",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "FOOD_FEE",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "SKIN_PRICE",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "SPECIAL_MINT_PRICE",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint8",
                        "name": "skinId",
                        "type": "uint8"
                    }
                ],
                "name": "applySkin",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "approve",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    }
                ],
                "name": "balanceOf",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint8",
                        "name": "current",
                        "type": "uint8"
                    },
                    {
                        "internalType": "uint8",
                        "name": "target",
                        "type": "uint8"
                    }
                ],
                "name": "calculateUpgradeCost",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "pure",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "coins",
                "outputs": [
                    {
                        "internalType": "contract MonxiaCoin",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "count",
                        "type": "uint256"
                    }
                ],
                "name": "consumeBatch",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "consumeFromBalance",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "depositToGame",
                "outputs": [],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "name": "gameBalances",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "getApproved",
                "outputs": [
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    },
                    {
                        "internalType": "address",
                        "name": "operator",
                        "type": "address"
                    }
                ],
                "name": "isApprovedForAll",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "name": "isClassicSnake",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    }
                ],
                "name": "mintClassic",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    }
                ],
                "name": "mintFastSnake",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    }
                ],
                "name": "mintHeartySnake",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    }
                ],
                "name": "mintLongSnake",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "name",
                "outputs": [
                    {
                        "internalType": "string",
                        "name": "",
                        "type": "string"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "owner",
                "outputs": [
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "ownerOf",
                "outputs": [
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "payForFood",
                "outputs": [],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint8",
                        "name": "",
                        "type": "uint8"
                    },
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "name": "personalBests",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "renounceOwnership",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "from",
                        "type": "address"
                    },
                    {
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "safeTransferFrom",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "from",
                        "type": "address"
                    },
                    {
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    },
                    {
                        "internalType": "bytes",
                        "name": "data",
                        "type": "bytes"
                    }
                ],
                "name": "safeTransferFrom",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "operator",
                        "type": "address"
                    },
                    {
                        "internalType": "bool",
                        "name": "approved",
                        "type": "bool"
                    }
                ],
                "name": "setApprovalForAll",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "newTreasury",
                        "type": "address"
                    }
                ],
                "name": "setTreasury",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "name": "snakeAttributes",
                "outputs": [
                    {
                        "internalType": "uint8",
                        "name": "speed",
                        "type": "uint8"
                    },
                    {
                        "internalType": "uint8",
                        "name": "hearts",
                        "type": "uint8"
                    },
                    {
                        "internalType": "uint8",
                        "name": "length",
                        "type": "uint8"
                    },
                    {
                        "internalType": "uint8",
                        "name": "skin",
                        "type": "uint8"
                    },
                    {
                        "internalType": "bool",
                        "name": "isClassic",
                        "type": "bool"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "bytes4",
                        "name": "interfaceId",
                        "type": "bytes4"
                    }
                ],
                "name": "supportsInterface",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "symbol",
                "outputs": [
                    {
                        "internalType": "string",
                        "name": "",
                        "type": "string"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "tokenURI",
                "outputs": [
                    {
                        "internalType": "string",
                        "name": "",
                        "type": "string"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint8",
                        "name": "",
                        "type": "uint8"
                    },
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "name": "topPlayers",
                "outputs": [
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint8",
                        "name": "",
                        "type": "uint8"
                    },
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "name": "topScores",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "from",
                        "type": "address"
                    },
                    {
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "transferFrom",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "newOwner",
                        "type": "address"
                    }
                ],
                "name": "transferOwnership",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "treasury",
                "outputs": [
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            }
        ];

      
    const supabase = supabase.createClient('https://wusexxzubjfrxifelgob.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...');

    // Wallet connection handlers
    document.getElementById('connectBtn').addEventListener('click', async () => {
      try {
        const provider = await modal.open();
        if (provider) {
          const accounts = await provider.request({ method: 'eth_accounts' });
          userAddress = accounts[0];
          updateWalletUI();
        }
      } catch (e) {
        console.error('Connection failed:', e);
      }
    });

    document.getElementById('disconnectBtn').addEventListener('click', () => {
      modal.closeModal();
      userAddress = null;
      updateWalletUI();
    });

    function updateWalletUI() {
      const addrEl = document.getElementById('addr');
      const connectBtn = document.getElementById('connectBtn');
      const disconnectBtn = document.getElementById('disconnectBtn');
      
      if (userAddress) {
        addrEl.textContent = `${userAddress.slice(0,6)}...${userAddress.slice(-4)}`;
        connectBtn.style.display = 'none';
        disconnectBtn.style.display = 'inline-block';
      } else {
        addrEl.textContent = 'Not connected';
        connectBtn.style.display = 'inline-block';
        disconnectBtn.style.display = 'none';
      }
    }

    // Basic game setup (add your full game logic here)
    document.getElementById('newGame').addEventListener('click', () => {
      document.getElementById('menu').style.display = 'none';
      document.getElementById('gameHolder').style.display = 'block';
      // Add game initialization
    });

  </script>
</body>
</html>
